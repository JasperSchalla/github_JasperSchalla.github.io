<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<style>

		html {
			margin: 0;
			padding: 0;
			width: 100vw;
			height: 100vh;
		}

		:root {
			--main-bg-color: rgb(47, 44, 44);
			--feat-color: #1ED760;
			--font-color: white;
		}

		body {
			background-color: var(--main-bg-color);
			color: var(--font-color);
			overflow-x: hidden;
		}

		#header {
			text-align: center;
		}

		#body {
			padding: 3rem 0 1rem 0;

		}

		#songs {
			display: flex;
			flex-direction: column;
			justify-content: center;
			width: 75%;
			margin: 0 auto;
		}

		.entry {
			display: flex;
			flex-direction: row;
			align-items: center;
			margin-bottom: 1.5rem;
		}

		.entry > p:first-child{
		}

		.entry > img {
			margin-left: 2rem;
		}

		.entry > p:last-child {
			margin-left: 2rem;
		}

		#btn-div {
			display: flex;
			width: 75%;
			margin: 0 auto;
			justify-content: center;
			margin-bottom: 4rem;
		}

		button {
			width: 100px;
			font-size: 18px;
			border: solid;
			color: black;
			background-color: var(--feat-color);
			border: none;
			cursor: pointer;
		}

		button:first-child {
			border-top-left-radius: 5px;
			border-bottom-left-radius: 5px;
			border-right: solid;
		}

		button:last-child {
			border-top-right-radius: 5px;
			border-bottom-right-radius: 5px;
			border-left: solid;
		}

		.active {
			background-color: #107935;
		}

		#footer {
			width: 75%;
			margin: 0 auto;
			padding-bottom: 2rem;
			text-align: center;
			color: rgb(175, 169, 169);
		}


	</style>
	<script>

	showSongs = function(time) {
		const div = document.getElementById("songs");
		div.textContent = '';

		const list = document.createDocumentFragment();

		const btn = document.getElementById(time);

		const btnChilds= document.getElementById("btn-div").children;

		for(let i=0;i<btnChilds.length;i++){
			btnChilds[i].classList.remove("active");
		}

		btn.classList.add("active");


		fetch("https://jasperschalla.github.io/top_songs.json")
			.then(response => response.json())
			.then(data => {

				console.log(data);
				console.log(time);
				let songs = data[time];
				
				for (let i=0;i<songs.songs.length;i++){
					let div = document.createElement("div");
					let counter = document.createElement("p");
					let text = document.createElement("p");
					let cover = document.createElement("img");

					div.classList.add("entry");

					counter.innerHTML = `${i+1}.`;

					cover.src = `${songs.covers[i]}`;
					cover.style.width = "80px";

					text.innerHTML += `${songs.songs[i]} - ${songs.artists[i]}`;

					div.appendChild(counter);
					div.appendChild(cover);
					div.appendChild(text);
					list.appendChild(div);
				}
				div.appendChild(list);
			}).catch(error => console.log(error));
		

	}

	window.onload = function () {

		const div = document.getElementById("songs");
		const list = document.createDocumentFragment();
		const footerList = document.createDocumentFragment();

		const short = document.getElementById("short");
		short.classList.add("active");

		const footer = document.getElementById("footer");

		fetch("https://jasperschalla.github.io/top_songs.json")
			.then(response => response.json())
			.then(data => {
				let songs = data.short;
				
				for (let i=0;i<songs.songs.length;i++){
					let div = document.createElement("div");
					let counter = document.createElement("p");
					let text = document.createElement("p");
					let cover = document.createElement("img");

					div.classList.add("entry");

					counter.innerHTML = `${i+1}.`;

					cover.src = `${songs.covers[i]}`;
					cover.style.width = "80px";

					text.innerHTML += `${songs.songs[i]} - ${songs.artists[i]}`;

					div.appendChild(counter);
					div.appendChild(cover);
					div.appendChild(text);
					list.appendChild(div);

				}
				div.appendChild(list);

				console.log(data);

				let updated = document.createElement("p");
				updated.innerHTML = `Updated: ${data.updated}`;
				footerList.appendChild(updated);
				footer.appendChild(footerList);

			}).catch(error => console.log(error));
		

	}
	</script>
	<body>
		<div id="header">
			<h1>Spotify Stats</h1>
		</div>
		<div id="body">
			<div id="btn-div">
				<button id="short" onclick='showSongs("short")''>Short</button>
				<button id="medium" onclick='showSongs("medium")''>Medium</button>
				<button id="long" onclick='showSongs("long")''>Long</button>
			</div>
			<div id="songs">
				
			</div>
		</div>
		<div id="footer">
		</div>
	</body>
</html>