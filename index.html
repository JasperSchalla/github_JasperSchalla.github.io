<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<style>

		html {
			margin: 0;
			padding: 0;
			width: 100vw;
			height: 100vh;
		}

		:root {
			--main-bg-color: rgb(47, 44, 44);
			--feat-color: #1ED760;
			--font-color: white;
		}

		body {
			background-color: var(--main-bg-color);
			color: var(--font-color);
			overflow-x: hidden;
		}

		#header {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: center;
		}

		.navlink:first-child {
			margin-right: 2rem;
		}

		.active_link {
			text-decoration: underline;
			text-decoration-color: var(--feat-color) ;
		}

		#body {
			padding: 2rem 0 1rem 0;

		}

		#songs {
			display: flex;
			flex-direction: column;
			justify-content: center;
			width: 60%;
			margin: 0 auto;
		}

		@media screen and (min-width: 900px) {
			#songs {
				width: 45%;
				border-left: solid;
				border-right: solid;
				padding: 0 5rem 0 5rem;
				border-width: 1px;
				border-color: rgb(62, 62, 62);
			}
		}

		.entry {
			display: flex;
			flex-direction: row;
			align-items: center;
			margin-bottom: 1.5rem;
		}

		.entry > p:first-child{
			font-size: 18px;
			background-color: var(--feat-color);
			color: black;
			padding: 0.35rem;
			border-radius: 50px;
		}

		.entry > a {
			margin-left: 2rem;
		}

		.entry > p:last-child {
			margin-left: 2rem;
		}

		#btn-div {
			display: flex;
			width: 75%;
			margin: 0 auto;
			justify-content: center;
			margin-bottom: 4rem;
		}

		button {
			width: 100px;
			font-size: 18px;
			border: solid;
			color: black;
			background-color: var(--feat-color);
			border: none;
			cursor: pointer;
		}

		button:first-child {
			border-top-left-radius: 5px;
			border-bottom-left-radius: 5px;
			border-right: solid;
		}

		button:last-child {
			border-top-right-radius: 5px;
			border-bottom-right-radius: 5px;
			border-left: solid;
		}

		.active {
			background-color: #107935;
		}

		#footer {
			width: 75%;
			margin: 0 auto;
			padding-bottom: 2rem;
			text-align: center;
			color: rgb(175, 169, 169);
		}


	</style>
	<script>

	clickLink = function(id) {
		
		const headerChilds = document.getElementById("header").children;

		for(let i=0;i<headerChilds.length;i++){
			headerChilds[i].classList.remove("active_link");
		}

		document.getElementById(id).classList.add("active_link");

		showList("short");

	}

	showList = function(time) {
		const div = document.getElementById("songs");
		div.textContent = '';

		const list = document.createDocumentFragment();

		const btn = document.getElementById(time);

		const btnChilds= document.getElementById("btn-div").children;

		for(let i=0;i<btnChilds.length;i++){
			btnChilds[i].classList.remove("active");
		}

		btn.classList.add("active");


		fetch("https://jasperschalla.github.io/spotify_stats.json")
			.then(response => response.json())
			.then(data => {

				if (document.getElementById("song_link").classList.contains("active_link")) {

					let songs = data.songs[time];
					
					for (let i=0;i<songs.songs.length;i++){
						let div = document.createElement("div");
						let counter = document.createElement("p");
						let text = document.createElement("p");
						let coverLink = document.createElement("a");
						let cover = document.createElement("img");

						div.classList.add("entry");

						counter.innerHTML = `${i+1}.`;

						cover.src = `${songs.covers[i]}`;
						cover.style.width = "80px";

						text.innerHTML += `${songs.songs[i]} - ${songs.artists[i]}`;

						coverLink.appendChild(cover);
						coverLink.href = `https://open.spotify.com/search/${encodeURIComponent(songs.songs[i])}`;

						div.appendChild(counter);
						div.appendChild(coverLink);
						div.appendChild(text);
						list.appendChild(div);
					}

					} else {

						let artists = data.artists[time];
					
						for (let i=0;i<artists.artists.length;i++){
							let div = document.createElement("div");
							let counter = document.createElement("p");
							let text = document.createElement("p");
							let cover = document.createElement("img");
							let coverLink = document.createElement("a");

							div.classList.add("entry");

							counter.innerHTML = `${i+1}.`;

							cover.src = `${artists.covers[i]}`;
							cover.style.width = "80px";

							text.innerHTML += `${artists.artists[i]}`;

							coverLink.appendChild(cover);
							coverLink.href = `https://open.spotify.com/artist/${artists.ids[i]}`;

							div.appendChild(counter);
							div.appendChild(coverLink);
							div.appendChild(text);
							list.appendChild(div);

						}

						div.appendChild(list);

						let updated = document.createElement("p");
						updated.innerHTML = `Updated: ${data.updated}`;
						footerList.appendChild(updated);
						footer.appendChild(footerList);						

					}
				div.appendChild(list);
			}).catch(error => console.log(error));
		

	}

	window.onload = function () {

		const div = document.getElementById("songs");
		const list = document.createDocumentFragment();
		const footerList = document.createDocumentFragment();

		const short = document.getElementById("short");
		short.classList.add("active");

		const footer = document.getElementById("footer");

		fetch("https://jasperschalla.github.io/spotify_stats.json")
			.then(response => response.json())
			.then(data => {

				let songs = data.songs.short;
				
				for (let i=0;i<songs.songs.length;i++){
					let div = document.createElement("div");
					let counter = document.createElement("p");
					let text = document.createElement("p");
					let cover = document.createElement("img");
					let coverLink = document.createElement("a");

					div.classList.add("entry");

					counter.innerHTML = `${i+1}.`;

					cover.src = `${songs.covers[i]}`;
					cover.style.width = "80px";

					text.innerHTML += `${songs.songs[i]} - ${songs.artists[i]}`;

					coverLink.appendChild(cover);
					coverLink.href = `https://open.spotify.com/search/${encodeURIComponent(songs.songs[i])}`;

					div.appendChild(counter);
					div.appendChild(coverLink);
					div.appendChild(text);
					list.appendChild(div);

				}
				div.appendChild(list);

				let updated = document.createElement("p");
				updated.innerHTML = `Updated: ${data.updated}`;
				footerList.appendChild(updated);
				footer.appendChild(footerList);

			}).catch(error => console.log(error));
		

	}
	</script>
	<body>
		<div id="header">
			<!--<h1>Spotify Top-Songs</h1>-->
			<a onclick="clickLink(this.id)" class="navlink active_link" id="song_link"><h2>Songs</h2></a>
			<a onclick="clickLink(this.id)" class="navlink" id="artist_link"><h2>Artists</h2></a>
		</div>
		<div id="body">
			<div id="btn-div">
				<button id="short" onclick='showList("short")''>Short</button>
				<button id="medium" onclick='showList("medium")''>Medium</button>
				<button id="long" onclick='showList("long")''>Long</button>
			</div>
			<div id="songs">
				
			</div>
		</div>
		<div id="footer">
		</div>
	</body>
</html>